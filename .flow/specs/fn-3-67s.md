# fn-3-67s Fix Export Zip functionality in Admin

## Overview
Fix the Export ZIP functionality in Admin PDFs page. Currently the button loads indefinitely with no error. The export should create a ZIP containing:
- All extracted report text files (report.txt)
- A manifest.json with metadata about each report for downstream analysis

## Scope
- Backend API: `/api/export-texts-zip/route.ts`
- Frontend: `src/app/admin/pdfs/pdfs-content.tsx`
- Convex query: `pdfs.getAllForExport`

## Problem Analysis
Current implementation issues:
1. **Timeout risk**: Fetches all PDFs and text content synchronously - times out for large datasets
2. **No progress feedback**: User sees only a spinning loader with no indication of progress
3. **No manifest**: Missing manifest.json with report metadata for downstream analysis
4. **Memory issues**: Buffers entire ZIP in memory before sending

## Approach
1. **Streaming architecture**: Use Server-Sent Events (SSE) for progress updates
2. **Batch processing**: Process files in batches to avoid timeouts
3. **Progress UI**: Show real-time progress (X of Y files processed)
4. **Manifest file**: Include manifest.json with:
   - Report ID, title, filename
   - Document type, summary
   - Creation date, source URL
   - Text file reference in ZIP

## Tasks
1. **fn-3-67s.1**: Investigate root cause of infinite loading
2. **fn-3-67s.2**: Implement streaming ZIP with progress tracking
3. **fn-3-67s.3**: Add manifest.json with report metadata
4. **fn-3-67s.4**: Update frontend with progress indicator

## Quick commands
- `npm run dev` - Start dev server
- `npm run build` - Build to verify changes

## Acceptance
- [ ] Export ZIP button works without hanging
- [ ] User sees progress (e.g., "Processing 5 of 50 reports...")
- [ ] ZIP contains all report.txt files
- [ ] ZIP contains manifest.json with report metadata
- [ ] Works for large datasets (100+ reports)
- [ ] Graceful error handling with user feedback

## References
- Current API: `src/app/api/export-texts-zip/route.ts`
- Frontend: `src/app/admin/pdfs/pdfs-content.tsx`
- Convex: `convex/pdfs.ts` (getAllForExport)
